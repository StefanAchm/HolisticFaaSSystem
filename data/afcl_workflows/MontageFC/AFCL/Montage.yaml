---
name: "montage_workflow"
dataIns:
- name: "bucket"
  type: "string"
  source: "bucket"
- name: "header"
  type: "string"
  source: "header"
- name: "color_folders"
  type: "collection"
  source: "color_folders"
- name: "aws_access_key_id"
  type: "string"
  source: "aws_access_key_id"
- name: "aws_secret_access_key"
  type: "string"
  source: "aws_secret_access_key"
- name: "aws_session_token"
  type: "string"
  source: "aws_session_token"
- name: "gcp_project_id"
  type: "string"
  source: "gcp_project_id"
- name: "gcp_client_email"
  type: "string"
  source: "gcp_client_email"
- name: "gcp_private_key"
  type: "string"
  source: "gcp_private_key"
workflowBody:
- function:
    name: "prepareColor"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "montage_workflow/bucket"
    - name: "header"
      type: "string"
      source: "montage_workflow/header"
    - name: "color_folders"
      type: "collection"
      source: "montage_workflow/color_folders"
    - name: "aws_access_key_id"
      type: "string"
      source: "montage_workflow/aws_access_key_id"
    - name: "aws_secret_access_key"
      type: "string"
      source: "montage_workflow/aws_secret_access_key"
    - name: "aws_session_token"
      type: "string"
      source: "montage_workflow/aws_session_token"
    - name: "gcp_project_id"
      type: "string"
      source: "montage_workflow/gcp_project_id"
    - name: "gcp_client_email"
      type: "string"
      source: "montage_workflow/gcp_client_email"
    - name: "gcp_private_key"
      type: "string"
      source: "montage_workflow/gcp_private_key"
    dataOuts:
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folders"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "preparemProjectPP"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "prepareColor/bucket"
    - name: "header"
      type: "string"
      source: "prepareColor/header"
    - name: "color_folder"
      type: "string"
      source: "prepareColor/color_folders"
    - name: "credentials"
      type: "collection"
      source: "prepareColor/credentials"
    dataOuts:
    - name: "filenames"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- parallelFor:
    name: "mProjectPPs"
    dataIns:
    - name: "filename"
      type: "string"
      source: "preparemProjectPP/filenames"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemProjectPP/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemProjectPP/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "color_folder"
      type: "string"
      source: "preparemProjectPP/color_folder"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "credentials"
      type: "collection"
      source: "preparemProjectPP/credentials"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemProjectPP/number"
      step: "1"
    loopBody:
    - function:
        name: "mProjectPP"
        type: "Collection"
        dataIns:
        - name: "filename"
          type: "string"
          source: "mProjectPPs/filename"
        - name: "bucket"
          type: "string"
          source: "mProjectPPs/bucket"
        - name: "header"
          type: "string"
          source: "mProjectPPs/header"
        - name: "color_folder"
          type: "string"
          source: "mProjectPPs/color_folder"
        - name: "credentials"
          type: "collection"
          source: "mProjectPPs/credentials"
        dataOuts:
        - name: "color_folder"
          type: "string"
        - name: "credentials"
          type: "collection"
        properties:
        - name: "resource"
          value: "<TODO>"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mProjectPPs/bucket"
    - name: "header"
      type: "string"
      source: "mProjectPPs/header"
    - name: "color_folder"
      type: "string"
      source: "mProjectPP/color_folder"
    - name: "credentials"
      type: "string"
      source: "mProjectPP/credentials"
    constraints:
    - name: "concurrency"
      value: "950"
- function:
    name: "preparemDiffFit"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mProjectPPs/bucket"
    - name: "header"
      type: "string"
      source: "mProjectPPs/header"
    - name: "color_folder"
      type: "string"
      source: "mProjectPPs/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mProjectPPs/credentials"
    dataOuts:
    - name: "diff_rows"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- parallelFor:
    name: "mDiffFits"
    dataIns:
    - name: "diff"
      type: "string"
      source: "preparemDiffFit/diff_rows"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemDiffFit/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemDiffFit/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "color_folder"
      type: "string"
      source: "preparemDiffFit/color_folder"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "credentials"
      type: "collection"
      source: "preparemDiffFit/credentials"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemDiffFit/number"
      step: "1"
    loopBody:
    - function:
        name: "mDiffFit"
        type: "Collection"
        dataIns:
        - name: "diff"
          type: "string"
          source: "mDiffFits/diff"
        - name: "bucket"
          type: "string"
          source: "mDiffFits/bucket"
        - name: "header"
          type: "string"
          source: "mDiffFits/header"
        - name: "color_folder"
          type: "string"
          source: "mDiffFits/color_folder"
        - name: "credentials"
          type: "collection"
          source: "mDiffFits/credentials"
        dataOuts:
        - name: "color_folder"
          type: "string"
        - name: "credentials"
          type: "collection"
        properties:
        - name: "resource"
          value: "<TODO>"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mDiffFits/bucket"
    - name: "header"
      type: "string"
      source: "mDiffFits/header"
    - name: "color_folder"
      type: "string"
      source: "mDiffFit/color_folder"
    - name: "credentials"
      type: "string"
      source: "mDiffFit/credentials"
    constraints:
    - name: "concurrency"
      value: "950"
- function:
    name: "mConcatFit"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mDiffFits/bucket"
    - name: "header"
      type: "string"
      source: "mDiffFits/header"
    - name: "color_folder"
      type: "string"
      source: "mDiffFits/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mDiffFits/credentials"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "mBgModel"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mConcatFit/bucket"
    - name: "header"
      type: "string"
      source: "mConcatFit/header"
    - name: "color_folder"
      type: "string"
      source: "mConcatFit/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mConcatFit/credentials"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "preparemBackground"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mBgModel/bucket"
    - name: "header"
      type: "string"
      source: "mBgModel/header"
    - name: "color_folder"
      type: "string"
      source: "mBgModel/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mBgModel/credentials"
    dataOuts:
    - name: "filenames"
      type: "collection"
    - name: "number"
      type: "number"
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- parallelFor:
    name: "mBackgrounds"
    dataIns:
    - name: "filename"
      type: "string"
      source: "preparemBackground/filenames"
      constraints:
      - name: "distribution"
        value: "BLOCK(1)"
    - name: "bucket"
      type: "string"
      source: "preparemBackground/bucket"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "header"
      type: "string"
      source: "preparemBackground/header"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "color_folder"
      type: "string"
      source: "preparemBackground/color_folder"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    - name: "credentials"
      type: "collection"
      source: "preparemBackground/credentials"
      constraints:
      - name: "distribution"
        value: "REPLICATE(*)"
    loopCounter:
      type: "number"
      from: "0"
      to: "preparemBackground/number"
      step: "1"
    loopBody:
    - function:
        name: "mBackground"
        type: "Collection"
        dataIns:
        - name: "filename"
          type: "string"
          source: "mBackgrounds/filename"
        - name: "bucket"
          type: "string"
          source: "mBackgrounds/bucket"
        - name: "color_folder"
          type: "string"
          source: "mBackgrounds/color_folder"
        - name: "credentials"
          type: "collection"
          source: "mBackgrounds/credentials"
        dataOuts:
        - name: "color_folder"
          type: "string"
        - name: "credentials"
          type: "collection"
        properties:
        - name: "resource"
          value: "<TODO>"
    dataOuts:
    - name: "bucket"
      type: "string"
      source: "mBackgrounds/bucket"
    - name: "header"
      type: "string"
      source: "mBackgrounds/header"
    - name: "color_folder"
      type: "string"
      source: "mBackground/color_folder"
    - name: "credentials"
      type: "string"
      source: "mBackground/credentials"
    constraints:
    - name: "concurrency"
      value: "950"
- function:
    name: "mImgtbl"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mBackgrounds/bucket"
    - name: "header"
      type: "string"
      source: "mBackgrounds/header"
    - name: "color_folder"
      type: "string"
      source: "mBackgrounds/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mBackgrounds/credentials"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "header"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "mAdd"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mImgtbl/bucket"
    - name: "header"
      type: "string"
      source: "mImgtbl/header"
    - name: "color_folder"
      type: "string"
      source: "mImgtbl/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mImgtbl/credentials"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "mShrink"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mAdd/bucket"
    - name: "color_folder"
      type: "string"
      source: "mAdd/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mAdd/credentials"
    dataOuts:
    - name: "bucket"
      type: "string"
    - name: "color_folder"
      type: "string"
    - name: "credentials"
      type: "collection"
    properties:
    - name: "resource"
      value: "<TODO>"
- function:
    name: "mViewer"
    type: "Collection"
    dataIns:
    - name: "bucket"
      type: "string"
      source: "mShrink/bucket"
    - name: "color_folder"
      type: "string"
      source: "mShrink/color_folder"
    - name: "credentials"
      type: "collection"
      source: "mShrink/credentials"
    properties:
    - name: "resource"
      value: "<TODO>"
